{"ast":null,"code":"import _regeneratorRuntime from\"/Users/anthonyfink/Work/mern-shorten/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/anthonyfink/Work/mern-shorten/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/anthonyfink/Work/mern-shorten/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useCallback,useEffect,useState}from\"react\";var storageName='userData';export var useAuth=function useAuth(){var _useState=useState(null),_useState2=_slicedToArray(_useState,2),token=_useState2[0],setToken=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),ready=_useState4[0],setReady=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),userId=_useState6[0],setUserId=_useState6[1];var login=useCallback(/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(jwtToken,id){return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setToken(jwtToken);setUserId(id);localStorage.setItem(storageName,JSON.stringify({token:jwtToken,userId:id}));case 3:case\"end\":return _context.stop();}}},_callee);}));return function(_x,_x2){return _ref.apply(this,arguments);};}(),[]);var logOut=useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:setToken(null);setUserId(null);localStorage.removeItem(storageName);case 3:case\"end\":return _context2.stop();}}},_callee2);})),[]);useEffect(function(){var data=JSON.parse(localStorage.getItem(storageName));if(data&&data.token){login(data.token,data.userId).then(function(r){return r;});}setReady(true);},[login]);return{login:login,logOut:logOut,token:token,userId:userId,ready:ready};};","map":{"version":3,"names":["useCallback","useEffect","useState","storageName","useAuth","token","setToken","ready","setReady","userId","setUserId","login","jwtToken","id","localStorage","setItem","JSON","stringify","logOut","removeItem","data","parse","getItem","then","r"],"sources":["/Users/anthonyfink/Work/mern-shorten/client/src/shared/hooks/auth.hook.js"],"sourcesContent":["import {useCallback, useEffect, useState} from \"react\";\n\nconst storageName = 'userData'\nexport const useAuth = () => {\n\tconst [token, setToken] = useState(null);\n\tconst [ready, setReady] = useState(false);\n\tconst [userId, setUserId] = useState(null);\n\n\tconst login = useCallback(async(jwtToken,id)=>{\n\t\tsetToken(jwtToken)\n\t\tsetUserId(id)\n\t\tlocalStorage.setItem(storageName,JSON.stringify({token:jwtToken,userId:id}))\n\t},[])\n\tconst logOut = useCallback(async()=>{\n\t\tsetToken(null)\n\t\tsetUserId(null)\n\t\tlocalStorage.removeItem(storageName);\n\t},[])\n\tuseEffect(()=>{\n\t\tconst data = JSON.parse(localStorage.getItem(storageName))\n\t\tif(data && data.token){\n\t\t\tlogin(data.token, data.userId).then(r =>r);\n\t\t}\n\t\tsetReady(true);\n\t},[login])\n\treturn {login,logOut,token,userId,ready};\n}\n"],"mappings":"mZAAA,OAAQA,WAAR,CAAqBC,SAArB,CAAgCC,QAAhC,KAA+C,OAA/C,CAEA,GAAMC,YAAW,CAAG,UAApB,CACA,MAAO,IAAMC,QAAO,CAAG,QAAVA,QAAU,EAAM,CAC5B,cAA0BF,QAAQ,CAAC,IAAD,CAAlC,wCAAOG,KAAP,eAAcC,QAAd,eACA,eAA0BJ,QAAQ,CAAC,KAAD,CAAlC,yCAAOK,KAAP,eAAcC,QAAd,eACA,eAA4BN,QAAQ,CAAC,IAAD,CAApC,yCAAOO,MAAP,eAAeC,SAAf,eAEA,GAAMC,MAAK,CAAGX,WAAW,4FAAC,iBAAMY,QAAN,CAAeC,EAAf,oHACzBP,QAAQ,CAACM,QAAD,CAAR,CACAF,SAAS,CAACG,EAAD,CAAT,CACAC,YAAY,CAACC,OAAb,CAAqBZ,WAArB,CAAiCa,IAAI,CAACC,SAAL,CAAe,CAACZ,KAAK,CAACO,QAAP,CAAgBH,MAAM,CAACI,EAAvB,CAAf,CAAjC,EAHyB,sDAAD,mEAIvB,EAJuB,CAAzB,CAKA,GAAMK,OAAM,CAAGlB,WAAW,wEAAC,0IAC1BM,QAAQ,CAAC,IAAD,CAAR,CACAI,SAAS,CAAC,IAAD,CAAT,CACAI,YAAY,CAACK,UAAb,CAAwBhB,WAAxB,EAH0B,wDAAD,GAIxB,EAJwB,CAA1B,CAKAF,SAAS,CAAC,UAAI,CACb,GAAMmB,KAAI,CAAGJ,IAAI,CAACK,KAAL,CAAWP,YAAY,CAACQ,OAAb,CAAqBnB,WAArB,CAAX,CAAb,CACA,GAAGiB,IAAI,EAAIA,IAAI,CAACf,KAAhB,CAAsB,CACrBM,KAAK,CAACS,IAAI,CAACf,KAAN,CAAae,IAAI,CAACX,MAAlB,CAAL,CAA+Bc,IAA/B,CAAoC,SAAAC,CAAC,QAAGA,EAAH,EAArC,EACA,CACDhB,QAAQ,CAAC,IAAD,CAAR,CACA,CANQ,CAMP,CAACG,KAAD,CANO,CAAT,CAOA,MAAO,CAACA,KAAK,CAALA,KAAD,CAAOO,MAAM,CAANA,MAAP,CAAcb,KAAK,CAALA,KAAd,CAAoBI,MAAM,CAANA,MAApB,CAA2BF,KAAK,CAALA,KAA3B,CAAP,CACA,CAvBM"},"metadata":{},"sourceType":"module"}